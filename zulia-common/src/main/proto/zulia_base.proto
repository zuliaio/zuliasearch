syntax = "proto3";

option java_package = "io.zulia.message";

message IdInfo {
    string id = 1;
    uint64 timestamp = 2;
    uint32 majorVersion = 3;
    uint32 minorVersion = 4;
    bool compressedDoc = 5;
}

enum MasterSlaveSettings {
    MASTER_ONLY = 0;
    SLAVE_ONLY = 1;
    MASTER_IF_AVAILABLE = 2;
}

message Node {
    string serverAddress = 1;
    uint32 servicePort = 2;
    uint32 restPort = 3;
    int64 heartbeat = 4;
    string version = 5;
}

message ResultDocument {
    string uniqueId = 1;
    string indexName = 2;
    bytes document = 3;
    bytes metadata = 4;
    int64 timestamp = 5;
}


message AssociatedDocument {
    string filename = 1;
    string documentUniqueId = 2;
    string indexName = 3;
    bytes document = 4;
    bytes metadata = 5;
    int64 timestamp = 6;
}

message ExternalDocument {
    string filename = 1;
    string documentUniqueId = 2;
    string indexName = 3;
    bytes registration = 4;
    int64 timestamp = 5;
}


message ShardCountResponse {
    uint32 shardNumber = 1;
    uint32 numberOfDocs = 2;
}


message Term {
    string value = 1;
    uint64 docFreq = 2;
    uint64 termFreq = 3;
    double score = 4;
}

message FuzzyTerm {
    string term = 1;
    uint32 editDistance = 2;
    uint32 prefixLength = 3; // default = 0
    bool noTranspositions = 4;
}


enum Similarity {
    BM25 = 0;
    TFIDF = 1;
    CONSTANT = 2;
    TF = 3;
}

message NodeStats {
    uint64 jvmUsedMemoryMB = 2;
    uint64 jvmFreeMemoryMB = 3;
    uint64 jvmTotalMemoryMB = 4;
    uint64 jvmMaxMemoryMB = 5;
    double freeDataDirSpaceGB = 6;
    double totalDataDirSpaceGB = 7;
    double usedDataDirSpaceGB = 8;
    string zuliaVersion = 9;
    repeated IndexStats indexStat = 10;
}

message IndexStats {
    string indexName = 1;
    repeated ShardCacheStats shardCacheStat = 2;
}

message ShardCacheStats {
    bool primary = 1;
    CacheStats pinnedCache = 2;
    CacheStats generalCache = 3;
}

message CacheStats {
    uint64 estimatedSize = 1;
    uint64 hitCount = 2;
    uint64 missCount = 3;
    uint64 totalLoadTime = 4;
    uint64 evictionCount = 5;
    uint64 resultSize = 6;
}

